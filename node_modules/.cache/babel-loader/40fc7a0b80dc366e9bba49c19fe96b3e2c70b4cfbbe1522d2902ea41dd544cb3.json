{"ast":null,"code":"import _slicedToArray from\"/home/xphi/Desktop/react/Excel-visualizer/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import*as XLSX from'xlsx';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),excelFile=_useState2[0],setExcelFile=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),typeError=_useState4[0],setTypeError=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),excelData=_useState6[0],setExcelData=_useState6[1];var handleFile=function handleFile(e){var fileTypes=['application/vnd.ms-excel','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','text/csv'];var selectedFile=e.target.files[0];if(selectedFile){if(selectedFile&&fileTypes.includes(selectedFile.type)){setTypeError(null);var reader=new FileReader();reader.readAsArrayBuffer(selectedFile);reader.onload=function(e){setExcelFile(e.target.result);};}else{setTypeError('Please select only excel file types');setExcelFile(null);}}else{console.log('Please select your file');}};var handleFileSubmit=function handleFileSubmit(e){e.preventDefault();if(excelFile!==null){var workbook=XLSX.read(excelFile,{type:'buffer'});var worksheetName=workbook.SheetNames[0];var worksheet=workbook.Sheets[worksheetName];var data=XLSX.utils.sheet_to_json(worksheet);setExcelData(data);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Upload & View Excel Sheets\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"form-group custom-form\",onSubmit:handleFileSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",className:\"form-control\",required:true,onChange:handleFile}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success btn-md\",children:\"UPLOAD\"}),typeError&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",role:\"alert\",children:typeError})]}),/*#__PURE__*/_jsx(\"div\",{className:\"viewer\",children:excelData?/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:Object.keys(excelData[0]).map(function(key){return/*#__PURE__*/_jsx(\"th\",{children:key},key);})})}),/*#__PURE__*/_jsx(\"tbody\",{children:excelData.map(function(individualExcelData,index){return/*#__PURE__*/_jsx(\"tr\",{children:Object.keys(individualExcelData).map(function(key){return/*#__PURE__*/_jsx(\"td\",{children:individualExcelData[key]},key);})},index);})})]})}):/*#__PURE__*/_jsx(\"div\",{children:\"No File is uploaded yet!\"})})]});}export default App;","map":{"version":3,"names":["React","useState","XLSX","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","excelFile","setExcelFile","_useState3","_useState4","typeError","setTypeError","_useState5","_useState6","excelData","setExcelData","handleFile","e","fileTypes","selectedFile","target","files","includes","type","reader","FileReader","readAsArrayBuffer","onload","result","console","log","handleFileSubmit","preventDefault","workbook","read","worksheetName","SheetNames","worksheet","Sheets","data","utils","sheet_to_json","className","children","onSubmit","required","onChange","role","Object","keys","map","key","individualExcelData","index"],"sources":["/home/xphi/Desktop/react/Excel-visualizer/src/App.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport * as XLSX from 'xlsx';\n\n\nfunction App() {\n  const [excelFile, setExcelFile] = useState(null);\n  const [typeError, setTypeError] = useState(null);\n  const [excelData, setExcelData] = useState(null);\n\n  const handleFile = (e) => {\n    let fileTypes = ['application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'text/csv'];\n    let selectedFile = e.target.files[0];\n    if (selectedFile) {\n      if (selectedFile && fileTypes.includes(selectedFile.type)) {\n        setTypeError(null);\n        let reader = new FileReader();\n        reader.readAsArrayBuffer(selectedFile);\n        reader.onload = (e) => {\n          setExcelFile(e.target.result);\n        }\n      }\n      else {\n        setTypeError('Please select only excel file types');\n        setExcelFile(null);\n      }\n    }\n    else {\n      console.log('Please select your file');\n    }\n  };\n  \n  const handleFileSubmit = (e) => {\n    e.preventDefault();\n    if (excelFile !== null) {\n      const workbook = XLSX.read(excelFile, { type: 'buffer' });\n      const worksheetName = workbook.SheetNames[0];\n      const worksheet = workbook.Sheets[worksheetName];\n      const data = XLSX.utils.sheet_to_json(worksheet);\n      setExcelData(data);\n    }\n  };\n\n  return (\n    \n    <div className=\"wrapper\">\n      <h3>Upload & View Excel Sheets</h3>\n\n      {/* Form */}\n      <form className=\"form-group custom-form\" onSubmit={handleFileSubmit}>\n        <input type=\"file\" className=\"form-control\" required onChange={handleFile} />\n        <button type=\"submit\" className=\"btn btn-success btn-md\">UPLOAD</button>\n        {typeError && (\n          <div className=\"alert alert-danger\" role=\"alert\">{typeError}</div>\n        )}\n      </form>\n\n      {/* View data */}\n      <div className=\"viewer\">\n        {excelData ? (\n          <div className=\"table-container\">\n            <table className=\"table\">\n              <thead>\n                <tr>\n                  {Object.keys(excelData[0]).map((key) => (\n                    <th key={key}>{key}</th>\n                  ))}\n                </tr>\n              </thead>\n              <tbody>\n                {excelData.map((individualExcelData, index) => (\n                  <tr key={index}>\n                    {Object.keys(individualExcelData).map((key) => (\n                      <td key={key}>{individualExcelData[key]}</td>\n                    ))}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        ) : (\n          <div>No File is uploaded yet!</div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"+HAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,MAAO,GAAK,CAAAC,IAAI,KAAM,MAAM,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAG7B,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,IAAAC,SAAA,CAAkCP,QAAQ,CAAC,IAAI,CAAC,CAAAQ,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAzCG,SAAS,CAAAF,UAAA,IAAEG,YAAY,CAAAH,UAAA,IAC9B,IAAAI,UAAA,CAAkCZ,QAAQ,CAAC,IAAI,CAAC,CAAAa,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAAzCE,SAAS,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAC9B,IAAAG,UAAA,CAAkChB,QAAQ,CAAC,IAAI,CAAC,CAAAiB,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAAzCE,SAAS,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAE9B,GAAM,CAAAG,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAIC,CAAC,CAAK,CACxB,GAAI,CAAAC,SAAS,CAAG,CAAC,0BAA0B,CAAE,mEAAmE,CAAE,UAAU,CAAC,CAC7H,GAAI,CAAAC,YAAY,CAAGF,CAAC,CAACG,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CACpC,GAAIF,YAAY,CAAE,CAChB,GAAIA,YAAY,EAAID,SAAS,CAACI,QAAQ,CAACH,YAAY,CAACI,IAAI,CAAC,CAAE,CACzDZ,YAAY,CAAC,IAAI,CAAC,CAClB,GAAI,CAAAa,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAC7BD,MAAM,CAACE,iBAAiB,CAACP,YAAY,CAAC,CACtCK,MAAM,CAACG,MAAM,CAAG,SAACV,CAAC,CAAK,CACrBV,YAAY,CAACU,CAAC,CAACG,MAAM,CAACQ,MAAM,CAAC,CAC/B,CAAC,CACH,CAAC,IACI,CACHjB,YAAY,CAAC,qCAAqC,CAAC,CACnDJ,YAAY,CAAC,IAAI,CAAC,CACpB,CACF,CAAC,IACI,CACHsB,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC,CACxC,CACF,CAAC,CAED,GAAM,CAAAC,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAId,CAAC,CAAK,CAC9BA,CAAC,CAACe,cAAc,CAAC,CAAC,CAClB,GAAI1B,SAAS,GAAK,IAAI,CAAE,CACtB,GAAM,CAAA2B,QAAQ,CAAGpC,IAAI,CAACqC,IAAI,CAAC5B,SAAS,CAAE,CAAEiB,IAAI,CAAE,QAAS,CAAC,CAAC,CACzD,GAAM,CAAAY,aAAa,CAAGF,QAAQ,CAACG,UAAU,CAAC,CAAC,CAAC,CAC5C,GAAM,CAAAC,SAAS,CAAGJ,QAAQ,CAACK,MAAM,CAACH,aAAa,CAAC,CAChD,GAAM,CAAAI,IAAI,CAAG1C,IAAI,CAAC2C,KAAK,CAACC,aAAa,CAACJ,SAAS,CAAC,CAChDtB,YAAY,CAACwB,IAAI,CAAC,CACpB,CACF,CAAC,CAED,mBAEEtC,KAAA,QAAKyC,SAAS,CAAC,SAAS,CAAAC,QAAA,eACtB5C,IAAA,OAAA4C,QAAA,CAAI,4BAA0B,CAAI,CAAC,cAGnC1C,KAAA,SAAMyC,SAAS,CAAC,wBAAwB,CAACE,QAAQ,CAAEb,gBAAiB,CAAAY,QAAA,eAClE5C,IAAA,UAAOwB,IAAI,CAAC,MAAM,CAACmB,SAAS,CAAC,cAAc,CAACG,QAAQ,MAACC,QAAQ,CAAE9B,UAAW,CAAE,CAAC,cAC7EjB,IAAA,WAAQwB,IAAI,CAAC,QAAQ,CAACmB,SAAS,CAAC,wBAAwB,CAAAC,QAAA,CAAC,QAAM,CAAQ,CAAC,CACvEjC,SAAS,eACRX,IAAA,QAAK2C,SAAS,CAAC,oBAAoB,CAACK,IAAI,CAAC,OAAO,CAAAJ,QAAA,CAAEjC,SAAS,CAAM,CAClE,EACG,CAAC,cAGPX,IAAA,QAAK2C,SAAS,CAAC,QAAQ,CAAAC,QAAA,CACpB7B,SAAS,cACRf,IAAA,QAAK2C,SAAS,CAAC,iBAAiB,CAAAC,QAAA,cAC9B1C,KAAA,UAAOyC,SAAS,CAAC,OAAO,CAAAC,QAAA,eACtB5C,IAAA,UAAA4C,QAAA,cACE5C,IAAA,OAAA4C,QAAA,CACGK,MAAM,CAACC,IAAI,CAACnC,SAAS,CAAC,CAAC,CAAC,CAAC,CAACoC,GAAG,CAAC,SAACC,GAAG,qBACjCpD,IAAA,OAAA4C,QAAA,CAAeQ,GAAG,EAATA,GAAc,CAAC,EACzB,CAAC,CACA,CAAC,CACA,CAAC,cACRpD,IAAA,UAAA4C,QAAA,CACG7B,SAAS,CAACoC,GAAG,CAAC,SAACE,mBAAmB,CAAEC,KAAK,qBACxCtD,IAAA,OAAA4C,QAAA,CACGK,MAAM,CAACC,IAAI,CAACG,mBAAmB,CAAC,CAACF,GAAG,CAAC,SAACC,GAAG,qBACxCpD,IAAA,OAAA4C,QAAA,CAAeS,mBAAmB,CAACD,GAAG,CAAC,EAA9BA,GAAmC,CAAC,EAC9C,CAAC,EAHKE,KAIL,CAAC,EACN,CAAC,CACG,CAAC,EACH,CAAC,CACL,CAAC,cAENtD,IAAA,QAAA4C,QAAA,CAAK,0BAAwB,CAAK,CACnC,CACE,CAAC,EACH,CAAC,CAEV,CAEA,cAAe,CAAAzC,GAAG"},"metadata":{},"sourceType":"module","externalDependencies":[]}